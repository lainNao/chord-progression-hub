# 目次

- メタ
  - [基本プロフィール](#基本プロフィール)
  - [メタ機能](#メタ機能)
- 機能
  - [各種設定機能](#各種設定機能)
  - [ユーザー系機能](#ユーザー系機能)
  - [ユーザー種別](#ユーザー種別)
  - [認証認可](#認証認可)
  - [コード進行機能](#コード進行機能)
  - [機能リクエスト](#機能リクエスト)
  - [コード進行リクエスト](#コード進行リクエスト)
  - [リスト機能](#リスト機能)
  - [記事機能](#記事機能)
- 裏機能
  - [バッチ処理一覧](#バッチ処理一覧)
- ページ
  - メイン機能ページ
    - [TOPページ](#topページ)
    - [コード進行検索結果ページ](#コード進行検索結果ページ)
    - [コード進行詳細ページ](#コード進行詳細ページ)
  - サブ系ページ
    - [コード進行当てチャレンジページ](#コード進行当てチャレンジページ)
  - 認証後ページ
    - [マイページ](#マイページ)
  - 事務系ページ
    - [aboutページ](#aboutページ)
    - [faqページ](#faqページ)
- UI
  - [UI方針](#ui方針)
  - コンポーネント
    - [コード進行検索窓コンポーネント](#コード進行検索窓コンポーネント)
    - [コード進行入力コンポーネント](#コード進行入力コンポーネント)
    - [コントリビューショングラフ](#コントリビューショングラフ)

## 記事機能

```md
### 補足（記事機能とは）
・公式記事（コードaiみたいなアプリを紹介するとか）or、ユーザー投稿記事
```

- 記事のCRUD
  - コメント（とそれに付随するいいね）
  - いいね
  - お礼

## リスト機能

```md
### 補足（リスト機能とは）
・ユーザーが独自に何個でも作れるタイトルとコメントつきキュレーション。
・対象はURL、アーティスト、コード進行、など
・URLの場合例えば、アーティストがコード進行について語ってるツイートのURLとかYouTubeのURLとか、本のURLとかをイメージしてる。
・または単純に「◯◯なコード進行の曲リスト」みたいなリストではその曲のYouTubeのURLとか
```

- リストのCRUD
  - いいね
  - コメント（とそれに付随するいいね）

## コード進行機能

```md
### 補足（コード進行機能とは）
・コード進行を入力して、それに対していろいろな情報を付与する機能
```

- `検索`
  - いろんな検索ができる
  - コード進行を範囲選択して、その範囲と同じコード進行の曲を検索
  - アーティストページに行けば、そのアーティストのコード進行一覧を見れたりもするようにする
- `閲覧`
  - コード進行の閲覧
- `登録/編集/削除`
  - 専用UIでの登録orテキストでの登録を選べる
  - 差分をgitのように保存履歴で残せる（誰がどこをどういじったとかが履歴で残る）
  - 公開範囲の設定（スタンダード以上だとプライベートorURL知ってる人オンリーにできる）
- `付随機能`
  - 共有
  - 曲情報
  - いいね
  - コメント（とそれに付随するいいね）
  - タグ
  - 類似コード進行リスト
  - 関連アーティスト
- `アーティスト機能`
  - アーティストページにサマリー情報表示（更新があったアーティストに対して1日毎にバッチ更新）
    - 頻出コード進行（ディグリー表示）
    - テンションコード利用率
    - ディグリーの割合（T=30%、S=〜、D=~）
  - 登録されたコード進行の一覧

## ユーザー系機能

```md
### 補足（ユーザー系機能とは）
・アカウント管理機能（プロフィールや、自分やフォロイーのタイムラインや、他各種CRUD履歴など）
・各種投稿ごとに公開範囲の設定が可能
```

- フォロー
  - フォロイーのコンテンツとか、自分のCRUD履歴とかのタイムラインが作られる
- バッジ（称号を与える。メルカリやスプラトゥーンのような）
- DM
- いいねしたコンテンツ一覧
- 通報
- ブロック（ブロックしたユーザーのコンテンツは表示されない）

## 各種設定機能

- `捕捉（設定機能のページ分けの方針）`
  - 設定ページの設計は2パターン（各エンティティのページに一つずつ設定ページを付属させるorグローバルに一つ大きい設定ページを作る）ありそうだが、「メタ設定的なものはグローバルに一つ」、「細かい末端な設定においては各エンティティに付属させてもよい」という方針としておく
- `メタ設定`
  - `サイト設定`
    - `UI設定`
      - テーマカラー
      - フォントサイズ
      - 表示言語
      - タイムゾーン
    - `通知設定`
      - 通知の受け取り設定
      - サイトからのお知らせの受け取り設定
        - 好きなコード進行を登録したら、それと類似するコード進行が投稿されたら通知する
  - `プロフィール設定`
    - `公開情報設定`
      - プロフィール画像
      - ユーザー名
      - プロフィール文
      - SNSアカウント
  - `プラン設定`
    - プランの変更
- `機能設定`

## ユーザー種別

| | anonymous | freeユーザー | grantedユーザー |
| --- | --- | --- | --- |
| コア機能（コード進行機能）のCRUD | ○ | ○ | ○ |
| 自分以外が投稿したコード進行の編集 | 0 | 無制限 | 無制限 |
| アカウント情報が必要になる機能（コメント機能、ユーザー設定、etc）のCRUD | ✗ | ○ | ○ |
| リクエストを出せるか | ✗ | ○ | ○ |
| コードの編集者名をプライベートにできる機能 | ✗ | ○ | ○ |
| 好きなコード進行を登録し、それと類似するコード進行が投稿されたら通知する機能の登録できる数 | ✗ | 3 | 30 |
| Web API | ✗ | ✗ | ○ |
| 広告OFF機能 | ✗ | ✗ | ○ |
| コードの公開範囲をプライベートorURLを知ってる人オンリーにできる機能 | ✗ | ✗ | ○ |

- grantedユーザーは、通常毎月のサブスク課金（妥当なところで一旦100円程度で…）が必要
- プランのアップグレードが必要な機能は使えなくても見せておいて、`Upgrade`ボタンを用意して誘導する
- UXをよくできる手法をひたすら取る
  - useOptimistic
  - URL間のアニメーション
  - etc

## マイページ

- タイムライン（CRUD履歴など）
  - 鍵をかけられる
- 自分が投稿したものを、指定区分で表示できる（日時別、アーティスト別）
  - プライベートなものは鍵マークがつく
- 捕捉
  - 投稿履歴は他の人には見せない。著作権法上問題無いとは言え、他人の楽譜を投稿しているのだから、見られたくない気がするので。
  - ログ類も不要かも。お金かかるし。そもそもログ使わないはず

## TOPページ

- GitHubのトップページ結構かっこいい <https://github.com/>
- 左上あたりかヘッダーのどこかあたりに登録ボタンを置く

## faqページ

- 余裕がある時に著作権周りのFAQを用意。<https://support.chordify.net/hc/en-us/articles/360001420738-Does-this-not-infringe-copyright->が参考になる

## コード進行検索結果ページ

- GitHubのように、タイトルとコード詳細の関連部分の表示を1曲ごとに行う

## コード進行詳細ページ

- メイン
  - コード進行詳細表示（タブなどで複数のバージョンを切り替えられる）
  - 編集機能
    - 自分が編集してる時に他人が編集したら、うまくマージする（楽観的ロック、差分更新的な）
    - 編集履歴差分表示機能
    - raw textで編集する機能（リアルタイムバリデーションも行いたい）
      - raw textをコピーする機能（<https://www.npmjs.com/package/copy-to-clipboard>等）
- サブ
  - youtubeの検索結果
- デザイン
  - 背景色とかをググった検索結果の色を参考に薄くグラデーションさせるなどする

## コード進行当てチャレンジページ

- コード進行を聞いてそのコード進行を当てるゲーム
  - レベルが複数あり、GODレベルはやばいほど複雑なコードが出る。
- OGPありでSNSに結果を投稿できる
- できるならCloudflare pagesとかに置いてもいい

## aboutページ

- xxx

## コントリビューショングラフ

- GitHub等のように、コントリビューションしたら他人から見れるようにする

## コード進行入力コンポーネント

- セクションとその中の□がデフォルトで一つあり、その上で以下操作ができる
    |                | UIでやる | キーボードでやる |
    |----------------|---------|----------------|
    | セクション追加 |　下あたりにある「セクション追加」押下 | shiftとプラスキー |
    | セクションメタ追加 | | |
    | セクションメタ削除 | | |
    | コードブロック追加 | 右隣（または左下）の半透明になっている□押下 | □にフォーカスがある状態でshiftとプラスキー |
    | コードインフォ追加 | すぐ右隣の半透明になっている□押下 | □にフォーカスがある状態でcommandとプラスキー |
    | コード選択 | □クリックして選択肢押下。選択肢は2列あり、左列がコードで右列がテンション | □にフォーカスがある状態でエンターで選択肢開く。2列の選択肢は上下左右で移動して選択できて、エンターで決定 |
    | コードメタ追加 |  | |
    | コードメタ削除 | | |
    | コードブロック移動 | 略 | 普通にtabやshift+tabの基本的な操作で移動 |
    | コードインフォ移動 | 略 | 普通にtabやshift+tabの基本的な操作で移動 |
    | コードインフォ削除 | バックスペース | バックスペース |
- 見た目的には結構小さくて良い。既存のサービスはやっぱりでかいので。

    ```ui
    □ - □ - □ - □
    □ - □ - □ - □
    ```

- 将来的にはテキストでの入力をやれるようにしたい
  - でもそれならパーサーの方をバリデーションにも使えるようにしたい。エラーは行数や列数と合わせて表示できるようにパーサーを少しリファクタする必要ある
- 検索してその曲の詳細ページにアクセスしたら、その検索で引っかかった該当箇所をハイライト表示とかした

## コード進行検索窓コンポーネント

```UI
---------------------------------
|  C - Em - Gm7 - A    |  検索   |
---------------------------------
```

- 検索窓を押下すると、下に以下の詳細条件設定部分が表示されてモーダルっぽくなる
- 「C - Em - Gm7 - A」のようなものはデフォルトで入力されているようにする。これはテキストではなく専用の入力UIを使う。だってテキストはわからないから。

```UI
<検索の仕方>
  ✔ 実コード（デフォルト）
  ◯ ディグリー
  ◯ 機能

<コード進行をどのセクションから検索したいか>
  ✔ 1曲の中で （デフォルト）
  ◯ 特定セクションのみ
    ◯ セクション名: [  ]
    ◯ 指定のコード進行がセクションをまたいでも検索に引っかかるようにする (?)

<検索箇所>
  ✔ を含む（デフォルト）
  ◯ で始まる
  ◯ で終わる

<コード進行がどのくらい一致したら検索に引っかかるようにしたいか>
  ✔ 類似一致 （デフォルト）
  ◯ 完全一致のみ
  
--- その他詳細 --- （これはこのボタンを押したら表示する）

<曲の特徴>
  ジャンル [  ]
  国 [  ]
  BPM [  ]

<除外設定>
  投稿者ID: [  ]
  いいね数が[ ]以上のものだけ検索
  いいね数が[ ]以下のものだけ検索
  ...
    
[ 検索の詳細設定をデフォルトに戻す ]

```

## バッチ処理一覧

- xxx

## 機能リクエスト

- [ ] AST上足りないコード表現とかはユーザーからのリクエストを受けて増やすなどする(spec-20231221012340)
  - ただ、検索システム上受け付けない表現はある。例えば「7(13)」のような表現は13に統一している。これは検索システムの都合上諦めている部分。ただよい代案があれば対応したい。

## 認証認可

- [ ] ログインは「Googleログイン」と「メールアドレス＋パスワード」の2種類を用意したい。(spec-20231221012254)
  - [ ] できればパスキーログインも(spec-20231221012256)

## コード進行リクエスト

- 有料or無料での分析orコード進行投稿or公式記事orサイト機能のリクエストをする機能
- リクエストのCRUD
  - 回答
    - お礼
- [ ]「これを満たせばOKですよ」という条件を明記させる。例えば「7thレベルまでは網羅」「イントロからアウトロまで省略しない」とか。(spec-20231221010918)

## 基本プロフィール

- 競合サイトは以下
  - ChordU
  - Chordify
  - Chord ai
    - むしろ提携したい
  - 他音楽系サービス
    - Spotify
    - SoundCloud
    - Bandcamp  
    - Amazon Music
    - Apple Music
- [ ] 対応ブラウザは「Chrome、Safari、Firefox、Edge」の「デスクトップ＆モバイル」の「最新バージョン＆一個前のバージョン」(spec-20231221010424)
- コード進行の検索に特化したサイトにする
- あくまでもコード進行詳細ページはコード進行関連に徹する
  - SNSにありがちな「関連する◯◯」とか「おすすめ」とかは詳細ページには極力置かないで、それをするならコード進行の体験をよくする
    - そういうの置きたいならマイページとかに置く
- このサービスは、単に著作権法上問題無い（はずな）だけで、あくまでも他人の著作物の上に成り立つものであることを忘れない
- このサービスは誰よりもそもそも自分が使いたいものであり、誰にも使われなくても別にかまわないはずのものであることを忘れない
  - 逆に、何かしら有料の料金プランを用意するならば自分のアカウントもその有料プランに登録すること。登録したくないのならば、そもそもそんなプラン用意する必要ないかもしれない（自分向けのサービスのはずなので）

## メタ機能

- [ ] OGP機能(spec-20231221003217)
- [ ] HOME画面に追加（こういうやつ　<https://qiita.com/ryoko_yamazaki/items/f34d904d640fa6304fe0>）(spec-20231221003158)
- [ ] .well-known周りの充実（security.txtとか）(spec-20231221003320)
- [ ] もし広告用にクッキー使うなら、クッキー使いますよバナー(spec-20231221003900)

## UI方針

- [ ] 見た目は音楽とかコード進行とかのメンタルモデルに合わせる(spec-20231220222318)
- ユーザビリティを高くする
  - [ ] LottieやRive等でアニメーションを入れる（YouTubeの登録ボタンのエフェクトを参考にしたい）(spec-20231220222302)
  - [ ] ページ遷移時のアニメーションも必要なら混ぜる(spec-20231220222306)
- [ ] 完全に「キーボードでしか操作できない人」「目の見えない人」でも操作できるようにしたい。ADA compliant?(spec-20231220222316)
